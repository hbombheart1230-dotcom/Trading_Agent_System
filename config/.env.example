# Trading Agent System - Canonical Environment Template
# Copy this file to project root as `.env` and fill required secrets.
#
# Policy:
# - This is the single source of truth for env keys.
# - `config/env_example` and `config/env_example.m19_4_additions` are compatibility pointers.

# --------------------------------------------------------------------
# Core Runtime
# --------------------------------------------------------------------
RUNTIME_PROFILE=dev
KIWOOM_MODE=mock
DRY_RUN=1
LOG_LEVEL=INFO

# Execution control
EXECUTION_ENABLED=false
APPROVAL_MODE=manual
ALLOW_REAL_EXECUTION=false

# --------------------------------------------------------------------
# Safety and Risk
# --------------------------------------------------------------------
SYMBOL_ALLOWLIST=
MAX_ORDER_QTY=0
MAX_ORDER_NOTIONAL=0
RISK_DAILY_LOSS_LIMIT=0.0
RISK_PER_TRADE_LOSS_LIMIT=0.0
RISK_MAX_POSITIONS=1
RISK_ORDER_COOLDOWN_SEC=0

# --------------------------------------------------------------------
# Runtime Lifecycle / Preflight (M28)
# --------------------------------------------------------------------
# M28_PROFILE_STRICT=false
# M28_LIFECYCLE_STATE_PATH=data/state/m28_runtime_lifecycle.json
# M28_LIFECYCLE_LOCK_STALE_SEC=1800

# --------------------------------------------------------------------
# Core Paths
# --------------------------------------------------------------------
# EVENT_LOG_PATH=data/logs/events.jsonl
# REPORT_DIR=reports
# STATE_STORE_PATH=data/state.json
# KIWOOM_API_CATALOG_PATH=data/specs/api_catalog.jsonl

# --------------------------------------------------------------------
# Kiwoom Credentials and Endpoints
# --------------------------------------------------------------------
KIWOOM_APP_KEY=
KIWOOM_APP_SECRET=
KIWOOM_ACCOUNT_NO=
KIWOOM_BASE_URL_MOCK=https://mockapi.kiwoom.com
KIWOOM_BASE_URL_REAL=https://api.kiwoom.com
# KIWOOM_TOKEN_CACHE_PATH=data/token_cache.json
# KIWOOM_TOKEN_REFRESH_MARGIN_SEC=300
# KIWOOM_HTTP_TIMEOUT_SEC=10
# KIWOOM_RETRY_MAX=2
# KIWOOM_PAGINATION_MAX_CALLS=10

# --------------------------------------------------------------------
# OpenRouter (shared LLM base settings)
# --------------------------------------------------------------------
OPENROUTER_API_KEY=
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1
OPENROUTER_DEFAULT_MODEL=openai/gpt-4o-mini
OPENROUTER_DEFAULT_TEMPERATURE=0.2
OPENROUTER_DEFAULT_MAX_TOKENS=256
# OPENROUTER_MODEL_STRATEGIST=anthropic/claude-3.5-sonnet
# OPENROUTER_MODEL_SCANNER=openai/gpt-5-nano
# OPENROUTER_MODEL_REPORTER=google/gemini-2.5-flash-lite
# OPENROUTER_TIMEOUT_SEC=15
# OPENROUTER_HTTP_REFERER=https://your-domain-or-repo
# OPENROUTER_X_TITLE=Trading_Agent_System

# --------------------------------------------------------------------
# Strategist LLM Provider (M20)
# --------------------------------------------------------------------
# rule: deterministic local rules
# openai: OpenAI-compatible HTTP (OpenRouter endpoint supported)
AI_STRATEGIST_PROVIDER=rule

# API key priority:
# 1) AI_STRATEGIST_API_KEY
# 2) OPENROUTER_API_KEY (fallback)
AI_STRATEGIST_API_KEY=
AI_STRATEGIST_ENDPOINT=https://openrouter.ai/api/v1/chat/completions
AI_STRATEGIST_MODEL=openai/gpt-4o-mini
AI_STRATEGIST_TIMEOUT_SEC=15
AI_STRATEGIST_MAX_TOKENS=256
AI_STRATEGIST_RETRY_MAX=1
AI_STRATEGIST_RETRY_BACKOFF_SEC=0.5
AI_STRATEGIST_PROMPT_VERSION=m20-6
AI_STRATEGIST_SCHEMA_VERSION=intent.v1
AI_STRATEGIST_PROMPT_COST_PER_1K_USD=0
AI_STRATEGIST_COMPLETION_COST_PER_1K_USD=0
AI_STRATEGIST_JSON_RESPONSE_FORMAT=true

# --------------------------------------------------------------------
# News Provider (M19)
# --------------------------------------------------------------------
NAVER_CLIENT_ID=
NAVER_CLIENT_SECRET=
# SYMBOL_QUERY_MAP_JSON={"005930":"Samsung Electronics","000660":"SK hynix"}

# --------------------------------------------------------------------
# Alert Policy (M25)
# --------------------------------------------------------------------
# ALERT_POLICY_FAIL_ON=critical
# ALERT_POLICY_LLM_SUCCESS_RATE_MIN=0.70
# ALERT_POLICY_LLM_CIRCUIT_OPEN_RATE_MAX=0.30
# ALERT_POLICY_EXECUTION_BLOCKED_RATE_MAX=0.60
# ALERT_POLICY_EXECUTION_APPROVED_EXECUTED_GAP_MAX=0
# ALERT_POLICY_API_429_RATE_MAX=0.20
# ALERT_POLICY_PORTFOLIO_GUARD_BLOCKED_RATIO_MAX=0.70
# ALERT_POLICY_PORTFOLIO_GUARD_STRATEGY_BUDGET_EXCEEDED_MAX=20

# --------------------------------------------------------------------
# M25 Ops Batch and Notification
# --------------------------------------------------------------------
# M25_BATCH_EVENT_LOG_PATH=data/logs/m25_ops_batch_events.jsonl
# M25_BATCH_REPORT_DIR=reports/m25_ops_batch
# M25_BATCH_LOCK_PATH=data/state/m25_ops_batch.lock
# M25_BATCH_LOCK_STALE_SEC=1800
# M25_BATCH_STATUS_JSON_PATH=reports/m25_ops_batch/status_latest.json
# M25_NOTIFY_EVENT_LOG_PATH=data/logs/m25_notify_events.jsonl

# M25_NOTIFY_PROVIDER=none
# M25_NOTIFY_ON=failure
# M25_NOTIFY_WEBHOOK_URL=
# M25_NOTIFY_PORTFOLIO_GUARD_ESCALATION_MIN=0
# M25_NOTIFY_PORTFOLIO_GUARD_PROVIDER=none
# M25_NOTIFY_PORTFOLIO_GUARD_WEBHOOK_URL=
# M25_NOTIFY_TIMEOUT_SEC=5
# M25_NOTIFY_STATE_PATH=data/state/m25_notify_state.json
# M25_NOTIFY_DEDUP_WINDOW_SEC=600
# M25_NOTIFY_RATE_LIMIT_WINDOW_SEC=600
# M25_NOTIFY_MAX_PER_WINDOW=3
# M25_NOTIFY_RETRY_MAX=1
# M25_NOTIFY_RETRY_BACKOFF_SEC=0.5
# M25_NOTIFY_DRY_RUN=false
# M25_NOTIFY_FAIL_ON_ERROR=false
